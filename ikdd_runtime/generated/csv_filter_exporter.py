# Generated by IKDD Runtime v0.1

import csv
def load_csv(file_path):
    with open(file_path, newline='', encoding="utf-8") as f:
        return list(csv.DictReader(f))

def filter_rows(rows, filter_column, threshold):
    out = []
    for row in rows:
        val = row.get(filter_column)
        if val is None:
            continue
        try:
            if int(val) >= int(threshold):
                out.append(row)
        except ValueError:
            continue
    return out

import json
def export_json(rows, file_path):
    with open(file_path, "w", encoding="utf-8") as f:
        json.dump(rows, f, ensure_ascii=False, indent=2)

def csv_filter_exporter(csv_file, filter_column, threshold, json_file):
    rows = load_csv(csv_file)
    filtered = filter_rows(rows, filter_column, threshold)
    export_json(filtered, json_file)
    return filtered
