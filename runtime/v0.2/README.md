# IKDD Runtime v0.2 - Hybrid Runtime

> **æ±ºå®šè«–ã¨AIæ¨è«–ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**

## æ¦‚è¦

v0.2ã¯ã€**knowledgeã‚’ã€Œå‚è€ƒå®Ÿè£…ã€ã¨ã—ã¦æ‰±ã„ã€intentã«åŸºã¥ã„ã¦LLMãŒé©åˆ‡ã«çµ„ã¿åˆã‚ã›ã‚‹**ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§ã™ã€‚

## v0.1ã¨ã®é•ã„

| é …ç›® | v0.1 (Deterministic) | v0.2 (Hybrid) |
|------|---------------------|---------------|
| **knowledge** | å®Œå…¨ãªå®Ÿè£…ãŒå¿…é ˆ | å‚è€ƒå®Ÿè£…ã§OK |
| **intent** | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã¿ | ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã«ä½¿ç”¨ |
| **æŸ”è»Ÿæ€§** | ä½ã„ | é«˜ã„ |
| **å†ç¾æ€§** | 100% | é«˜ã„ï¼ˆLLMã®æ¸©åº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¬¡ç¬¬ï¼‰ |
| **é©ç”¨ç¯„å›²** | å®šå‹å‡¦ç† | è¤‡é›‘ãªè¦ä»¶ |

## è¨­è¨ˆæ€æƒ³

### v0.1ã®å•é¡Œç‚¹
```yaml
# v0.1ã§ã¯ã€snippetãŒå®Œå…¨ã§ãªã„ã¨å‹•ã‹ãªã„
knowledge:
  - id: CSV_LOAD
    snippet: |
      import csv
      def load_csv(file_path):
          # â† ã“ã®å®Ÿè£…ãŒå®Œç’§ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
```

### v0.2ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
```yaml
# v0.2ã§ã¯ã€snippetã¯ã€Œå‚è€ƒã€ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹
knowledge:
  - id: CSV_LOAD
    intent: "CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§dictå½¢å¼ã§è¿”ã™"
    reference_impl: |
      import csv
      def load_csv(file_path):
          with open(file_path) as f:
              return list(csv.DictReader(f))

    # LLMãŒ intent ã¨ reference_impl ã‚’å‚è€ƒã«ã€
    # tool.yaml ã® intent ã«æœ€é©ãªå®Ÿè£…ã‚’ç”Ÿæˆ
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆäºˆå®šï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ tool.yaml   â”‚  â† WHAT/WHYã‚’æ˜ç¢ºã«è¨˜è¿°
â”‚  + intent   â”‚
â”‚  + flow     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM Processor   â”‚  â† intentã‚’è§£é‡ˆ
â”‚                  â”‚
â”‚  1. tool intent  â”‚
â”‚  2. knowledge    â”‚
â”‚     reference    â”‚
â”‚  3. constraint   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Code Generator â”‚  â† é©åˆ‡ã«çµ„ã¿åˆã‚ã›ã¦å®Ÿè£…ç”Ÿæˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¸»ãªæ©Ÿèƒ½ï¼ˆè¨ˆç”»ï¼‰

### 1. Intent-driven Code Generation
- `tool.yaml`ã®intentã‚’ç†è§£
- knowledgeã®å‚è€ƒå®Ÿè£…ã‚’é©åˆ‡ã«ã‚¢ãƒ¬ãƒ³ã‚¸
- ä¸è¶³ã™ã‚‹éƒ¨åˆ†ã¯LLMãŒè£œå®Œ

### 2. Constraint Validation
- ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒåˆ¶ç´„ã‚’æº€ãŸã™ã‹æ¤œè¨¼
- ASTæ¤œè¨¼ã«ã‚ˆã‚‹å®‰å…¨æ€§ãƒã‚§ãƒƒã‚¯
- å‹ãƒã‚§ãƒƒã‚¯ï¼ˆoptionalï¼‰

### 3. Hybrid Approach
- æ±ºå®šè«–çš„éƒ¨åˆ†ï¼šåˆ¶ç´„ã€æ¤œè¨¼ã€ãƒ•ãƒ­ãƒ¼æ§‹é€ 
- AIæ¨è«–éƒ¨åˆ†ï¼šå®Ÿè£…ã®è©³ç´°ã€æœ€é©åŒ–

## ä½¿ç”¨ä¾‹ï¼ˆè¨ˆç”»ï¼‰

### tool.yaml
```yaml
tool:
  name: smart_csv_processor

  intent:
    what: "è¤‡æ•°ã®CSVã‚’èª­ã¿è¾¼ã¿ã€æ¡ä»¶ã«å¿œã˜ã¦ç•°ãªã‚‹å‡¦ç†ã‚’è¡Œã†"
    why: "ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã”ã¨ã«å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ãŒç•°ãªã‚‹ãŸã‚"

  constraints:
    - must_handle_encoding_errors
    - must_validate_columns
    - performance: "10MBä»¥å†…ã¯1ç§’ä»¥å†…"
```

### knowledge.yaml
```yaml
knowledge:
  - id: CSV_LOAD
    intent: "ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼ã‚’å‡¦ç†ã—ãªãŒã‚‰CSVã‚’èª­ã¿è¾¼ã‚€"
    reference_impl: |
      # åŸºæœ¬çš„ãªå®Ÿè£…ä¾‹
      import csv
      def load_csv(file_path):
          with open(file_path, encoding='utf-8') as f:
              return list(csv.DictReader(f))
```

v0.2ã§ã¯ã€ã“ã®ã€Œå‚è€ƒå®Ÿè£…ã€ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€`tool.yaml`ã®intentã«åˆã‚ã›ã¦æœ€é©åŒ–ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

ğŸš§ **é–‹ç™ºä¸­** - v0.2ã¯ç¾åœ¨è¨­è¨ˆãƒ»å®Ÿè£…æ®µéšã§ã™

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼ˆäºˆå®šï¼‰

- Python 3.8+
- LLM API (OpenAI / Anthropic / ãƒ­ãƒ¼ã‚«ãƒ«LLM)
- AST Parser / Validator
- YAML Parser
- Type Checker (optional)

---

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** v0.2 (In Development)
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:** Planning / Design Phase
**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:** Hybrid (Deterministic + AI Inference)
